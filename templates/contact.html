{% extends "base.html" %}

{% block header %}
<header
  class="masthead"
  style="background-image: url('{{ url_for('static', filename='assets/img/contact-bg.jpg') }}')"
>
  <div class="container position-relative px-4 px-lg-5">
    <div class="row gx-4 gx-lg-5 justify-content-center">
      <div class="col-md-10 col-lg-8 col-xl-7">
        <div class="page-heading">
          <h1>Contact Me</h1>
          <span class="subheading">Have questions? I have answers.</span>
        </div>
      </div>
    </div>
  </div>
</header>
{% endblock %}

{% block content %}
<main class="mb-4">
  <div class="container px-4 px-lg-5">
    <div class="row gx-4 gx-lg-5 justify-content-center">
      <div class="col-md-10 col-lg-8 col-xl-7" id="contactFormSection">

        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
              </div>
            {% endfor %}
          {% endif %}
        {% endwith %}

        <form method="POST" novalidate>
          {{ form.hidden_tag() }}

          <div class="form-floating mb-3">
            {{ form.name(class="form-control", placeholder="Name") }}
            {{ form.name.label() }}
            {% for error in form.name.errors %}
              <span class="text-danger" style="font-size: 0.8rem;">{{ error }}</span>
            {% endfor %}
          </div>

          <div class="form-floating mb-3">
            {{ form.email(class="form-control", placeholder="Email") }}
            {{ form.email.label() }}
            {% for error in form.email.errors %}
              <span class="text-danger" style="font-size: 0.8rem;">{{ error }}</span>
            {% endfor %}
          </div>

          <div class="form-floating mb-3">
            {{ form.phone(class="form-control", placeholder="Phone") }}
            {{ form.phone.label() }}
            {% for error in form.phone.errors %}
              <span class="text-danger" style="font-size: 0.8rem;">{{ error }}</span>
            {% endfor %}
          </div>

          <div class="form-floating mb-3">
            {{ form.message(class="form-control", style="height: 12rem") }}
            {{ form.message.label() }}
            {% for error in form.message.errors %}
              <span class="text-danger" style="font-size: 0.8rem;">{{ error }}</span>
            {% endfor %}
          </div>

          <button class="btn btn-primary text-uppercase" type="submit">
            Send Message
          </button>
        </form>

      </div>
    </div>
  </div>
</main>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener("DOMContentLoaded", () => { // Arrow functions are also more modern!
        const element = document.getElementById("contactFormSection");
        
        // Check if there are any Bootstrap alerts (Flash Messages)
        const hasFlashMessages = document.querySelector(".alert");
        
        // Check if there are any Validation Errors
        const hasValidationErrors = document.querySelector(".text-danger");

        // If the section exists AND (we have alerts OR we have errors)
        if (element && (hasFlashMessages || hasValidationErrors)) {
            element.scrollIntoView({ behavior: "smooth", block: "start" });
        }
    });
</script>
{% endblock %}
